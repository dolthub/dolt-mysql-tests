#
# Bug#21704: Renaming column does not update FK definition.
#

# Test that it's not possible to rename columns participating in a
# foreign key (either in the referencing or referenced table).

CREATE TABLE t1 (a INT PRIMARY KEY, b INT) ROW_FORMAT=COMPACT ENGINE=INNODB;
CREATE TABLE t2 (a INT PRIMARY KEY, b INT,
CONSTRAINT fk1 FOREIGN KEY (a) REFERENCES t1(a))
ROW_FORMAT=COMPACT ENGINE=INNODB;
CREATE TABLE t3 (a INT PRIMARY KEY, b INT, KEY(b), C INT,
CONSTRAINT fk2 FOREIGN KEY (b) REFERENCES t3 (a))
ROW_FORMAT=COMPACT ENGINE=INNODB;
INSERT INTO t1 VALUES (1,1),(2,2),(3,3);
updated
3
INSERT INTO t2 VALUES (1,1),(2,2),(3,3);
updated
3
INSERT INTO t3 VALUES (1,1,1),(2,2,2),(3,3,3);
updated
3

# Test renaming the column in the referenced table.

